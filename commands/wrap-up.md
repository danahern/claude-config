# Session Wrap-Up

End-of-session checklist. Do ALL of the following:

## 1. Review Changes

Run `git diff --stat` and `git status` in the workspace root and each submodule (`zephyr-apps/`, `claude-mcps/`, `claude-config/`). Summarize what was accomplished this session.

## 2. Capture Learnings

Review the session for any:
- Surprising behavior or bugs that took multiple attempts to fix
- Non-obvious configuration requirements
- Workarounds for tool/hardware quirks
- Patterns that should be reused

If any exist, capture each one using `knowledge.capture()` with appropriate metadata:
- **category**: `hardware` | `toolchain` | `pattern` | `operational`
- **severity**: `critical` | `important` | `informational`
- **boards/chips/tools/subsystems**: Scope the knowledge to what it applies to
- **file_patterns**: Glob patterns for auto-injection into rules files
- **tags**: 3-5 descriptive tags

Before creating, call `knowledge.search()` to check for duplicates.

After all learnings are captured, call `knowledge.regenerate_rules()` to update `.claude/rules/*.md`.

## 3. Update Documentation

If new apps, libraries, tools, or significant features were created:
- Update the relevant `CLAUDE.md` files (workspace, submodule, or library level)
- Keep workspace CLAUDE.md authoritative for cross-cutting concerns
- Keep submodule/library CLAUDE.md files specialized

## 4. Update Plans

Check `plans/` for any plans that were worked on this session. Update their status if progress was made (e.g., `In-Progress` → `Complete`). Completed plans stay in `plans/` — don't move or archive them.

## 5. Commit Everything

**Steps 2-4 create and modify files.** You MUST check for uncommitted changes now — do not assume the tree is clean because it was clean in step 1.

Run `git status --short` in the workspace root and each submodule. Pay special attention to:
- `knowledge/items/` — created/modified by `knowledge.capture()`
- `.claude/rules/` — regenerated by `knowledge.regenerate_rules()`
- `plans/` — updated in step 4
- `CLAUDE.md` files — updated in step 3

If there are ANY uncommitted changes in any repo, show them to the user and ask if they want to commit and push. If yes, commit each repo with descriptive messages.

## 6. Session Summary

Present a brief wrap-up:

```
Session Summary
- Accomplished: [2-3 bullet points]
- Learnings captured: [count, or "none"]
- Rules regenerated: [yes/no]
- Docs updated: [files, or "none"]
- Uncommitted: [files, or "all committed"]
```
